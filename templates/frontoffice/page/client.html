{% extends "frontoffice/master_page.html" %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-users me-2"></i>Gestion des Clients</h5>
                    <div>
                        <button class="btn btn-sm btn-light" id="addClientBtn"><i class="fas fa-plus me-1"></i>Ajouter Client</button>
                        <button class="btn btn-sm btn-light ms-2" id="exportClients"><i class="fas fa-download me-1"></i>Exporter</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover table-striped" id="clientsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Prénom</th>
                                    <th>Email</th>
                                    <th>Téléphone</th>
                                    <th>Adresse</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Client data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add/Edit Client Modal -->
<div class="modal fade" id="clientModal" tabindex="-1" aria-labelledby="clientModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="clientModalLabel">Ajouter Client</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="clientForm">
                    <input type="hidden" id="clientId">
                    <div class="mb-3">
                        <label for="nom" class="form-label">Nom</label>
                        <input type="text" class="form-control" id="nom" required>
                    </div>
                    <div class="mb-3">
                        <label for="prenom" class="form-label">Prénom</label>
                        <input type="text" class="form-control" id="prenom" required>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="telephone" class="form-label">Téléphone</label>
                        <input type="tel" class="form-control" id="telephone">
                    </div>
                    <div class="mb-3">
                        <label for="adresse" class="form-label">Adresse</label>
                        <textarea class="form-control" id="adresse" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                <button type="button" class="btn btn-primary" id="saveClient">Enregistrer</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Sample data for clients - would be replaced with real data from backend
    document.addEventListener('DOMContentLoaded', function() {
        // Sample client data
        var clientsData = [
            { id: 1, nom: 'Dupont', prenom: 'Jean', email: 'jean.dupont@example.com', telephone: '0123456789', adresse: '123 Rue de Paris, Paris' },
            { id: 2, nom: 'Martin', prenom: 'Marie', email: 'marie.martin@example.com', telephone: '0234567890', adresse: '456 Avenue des Champs, Lyon' },
            { id: 3, nom: 'Bernard', prenom: 'Pierre', email: 'pierre.bernard@example.com', telephone: '0345678901', adresse: '789 Boulevard Saint-Michel, Marseille' },
            { id: 4, nom: 'Petit', prenom: 'Sophie', email: 'sophie.petit@example.com', telephone: '0456789012', adresse: '101 Rue de la République, Toulouse' },
            { id: 5, nom: 'Robert', prenom: 'Thomas', email: 'thomas.robert@example.com', telephone: '0567890123', adresse: '202 Avenue Jean Jaurès, Nice' }
        ];
        
        // Populate clients table
        var clientsHtml = '';
        clientsData.forEach(function(client) {
            clientsHtml += `
                <tr>
                    <td>${client.id}</td>
                    <td>${client.nom}</td>
                    <td>${client.prenom}</td>
                    <td>${client.email}</td>
                    <td>${client.telephone}</td>
                    <td>${client.adresse}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-client" data-id="${client.id}"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-outline-danger delete-client" data-id="${client.id}"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `;
        });
        
        document.querySelector('#clientsTable tbody').innerHTML = clientsHtml;
        
        // Initialize DataTable
        $(document).ready(function() {
            $('#clientsTable').DataTable({
                "language": {
                    "url": "//cdn.datatables.net/plug-ins/1.10.24/i18n/French.json"
                }
            });
        });
        
        // Add Client button click
        document.getElementById('addClientBtn').addEventListener('click', function() {
            document.getElementById('clientModalLabel').textContent = 'Ajouter Client';
            document.getElementById('clientForm').reset();
            document.getElementById('clientId').value = '';
            var clientModal = new bootstrap.Modal(document.getElementById('clientModal'));
            clientModal.show();
        });
        
        // Edit Client button click
        document.querySelectorAll('.edit-client').forEach(function(button) {
            button.addEventListener('click', function() {
                var clientId = this.getAttribute('data-id');
                var client = clientsData.find(c => c.id == clientId);
                
                document.getElementById('clientModalLabel').textContent = 'Modifier Client';
                document.getElementById('clientId').value = client.id;
                document.getElementById('nom').value = client.nom;
                document.getElementById('prenom').value = client.prenom;
                document.getElementById('email').value = client.email;
                document.getElementById('telephone').value = client.telephone;
                document.getElementById('adresse').value = client.adresse;
                
                var clientModal = new bootstrap.Modal(document.getElementById('clientModal'));
                clientModal.show();
            });
        });
        
        // Save Client button click
        document.getElementById('saveClient').addEventListener('click', function() {
            // Here would be the code to save the client data
            alert('Client enregistré avec succès!');
            var clientModal = bootstrap.Modal.getInstance(document.getElementById('clientModal'));
            clientModal.hide();
        });
        
        // Delete Client button click
        document.querySelectorAll('.delete-client').forEach(function(button) {
            button.addEventListener('click', function() {
                var clientId = this.getAttribute('data-id');
                if (confirm('Êtes-vous sûr de vouloir supprimer ce client?')) {
                    // Here would be the code to delete the client
                    alert('Client supprimé avec succès!');
                }
            });
        });
    });
</script>
{% endblock %}
