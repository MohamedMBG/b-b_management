{% extends "frontoffice/master_page.html" %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-truck-fast me-2"></i>Gestion des Fournisseurs</h5>
                    <div>
                        <button class="btn btn-sm btn-light" id="addSupplierBtn"><i class="fas fa-plus me-1"></i>Ajouter Fournisseur</button>
                        <button class="btn btn-sm btn-light ms-2" id="exportSuppliers"><i class="fas fa-download me-1"></i>Exporter</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover table-striped" id="suppliersTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Email</th>
                                    <th>Téléphone</th>
                                    <th>Adresse</th>
                                    <th>Produits Fournis</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Supplier data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add/Edit Supplier Modal -->
<div class="modal fade" id="supplierModal" tabindex="-1" aria-labelledby="supplierModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="supplierModalLabel">Ajouter Fournisseur</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="supplierForm">
                    <input type="hidden" id="supplierId">
                    <div class="mb-3">
                        <label for="nom" class="form-label">Nom</label>
                        <input type="text" class="form-control" id="nom" required>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="telephone" class="form-label">Téléphone</label>
                        <input type="tel" class="form-control" id="telephone">
                    </div>
                    <div class="mb-3">
                        <label for="adresse" class="form-label">Adresse</label>
                        <textarea class="form-control" id="adresse" rows="3"></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="status" class="form-label">Statut</label>
                        <select class="form-select" id="status">
                            <option value="Actif">Actif</option>
                            <option value="Inactif">Inactif</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                <button type="button" class="btn btn-primary" id="saveSupplier">Enregistrer</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Sample data for suppliers - would be replaced with real data from backend
    document.addEventListener('DOMContentLoaded', function() {
        // Sample supplier data
        var suppliersData = [
            { id: 1, nom: 'Fournisseur A', email: 'contact@fournisseura.com', telephone: '0123456789', adresse: '123 Rue des Fournisseurs, Paris', produits: 15, statut: 'Actif' },
            { id: 2, nom: 'Fournisseur B', email: 'contact@fournisseurb.com', telephone: '0234567890', adresse: '456 Avenue des Distributeurs, Lyon', produits: 8, statut: 'Actif' },
            { id: 3, nom: 'Fournisseur C', email: 'contact@fournisseurc.com', telephone: '0345678901', adresse: '789 Boulevard des Grossistes, Marseille', produits: 12, statut: 'Actif' },
            { id: 4, nom: 'Fournisseur D', email: 'contact@fournisseurd.com', telephone: '0456789012', adresse: '101 Rue du Commerce, Toulouse', produits: 0, statut: 'Inactif' },
            { id: 5, nom: 'Fournisseur E', email: 'contact@fournisseure.com', telephone: '0567890123', adresse: '202 Avenue de l\'Industrie, Nice', produits: 5, statut: 'Actif' }
        ];
        
        // Populate suppliers table
        var suppliersHtml = '';
        suppliersData.forEach(function(supplier) {
            var statusClass = supplier.statut === 'Actif' ? 'bg-success' : 'bg-danger';
            
            suppliersHtml += `
                <tr>
                    <td>${supplier.id}</td>
                    <td>${supplier.nom}</td>
                    <td>${supplier.email}</td>
                    <td>${supplier.telephone}</td>
                    <td>${supplier.adresse}</td>
                    <td>${supplier.produits}</td>
                    <td><span class="badge ${statusClass}">${supplier.statut}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-supplier" data-id="${supplier.id}"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-outline-danger delete-supplier" data-id="${supplier.id}"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `;
        });
        
        document.querySelector('#suppliersTable tbody').innerHTML = suppliersHtml;
        
        // Initialize DataTable
        $(document).ready(function() {
            $('#suppliersTable').DataTable({
                "language": {
                    "url": "//cdn.datatables.net/plug-ins/1.10.24/i18n/French.json"
                }
            });
        });
        
        // Add Supplier button click
        document.getElementById('addSupplierBtn').addEventListener('click', function() {
            document.getElementById('supplierModalLabel').textContent = 'Ajouter Fournisseur';
            document.getElementById('supplierForm').reset();
            document.getElementById('supplierId').value = '';
            var supplierModal = new bootstrap.Modal(document.getElementById('supplierModal'));
            supplierModal.show();
        });
        
        // Edit Supplier button click
        document.querySelectorAll('.edit-supplier').forEach(function(button) {
            button.addEventListener('click', function() {
                var supplierId = this.getAttribute('data-id');
                var supplier = suppliersData.find(s => s.id == supplierId);
                
                document.getElementById('supplierModalLabel').textContent = 'Modifier Fournisseur';
                document.getElementById('supplierId').value = supplier.id;
                document.getElementById('nom').value = supplier.nom;
                document.getElementById('email').value = supplier.email;
                document.getElementById('telephone').value = supplier.telephone;
                document.getElementById('adresse').value = supplier.adresse;
                document.getElementById('status').value = supplier.statut;
                
                var supplierModal = new bootstrap.Modal(document.getElementById('supplierModal'));
                supplierModal.show();
            });
        });
        
        // Save Supplier button click
        document.getElementById('saveSupplier').addEventListener('click', function() {
            // Here would be the code to save the supplier data
            alert('Fournisseur enregistré avec succès!');
            var supplierModal = bootstrap.Modal.getInstance(document.getElementById('supplierModal'));
            supplierModal.hide();
        });
        
        // Delete Supplier button click
        document.querySelectorAll('.delete-supplier').forEach(function(button) {
            button.addEventListener('click', function() {
                var supplierId = this.getAttribute('data-id');
                if (confirm('Êtes-vous sûr de vouloir supprimer ce fournisseur?')) {
                    // Here would be the code to delete the supplier
                    alert('Fournisseur supprimé avec succès!');
                }
            });
        });
    });
</script>
{% endblock %}
